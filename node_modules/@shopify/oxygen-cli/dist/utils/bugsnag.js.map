{"version":3,"sources":["../../src/utils/bugsnag.ts"],"names":[],"mappings":"AAAA,OAAO,aAAa;AAGpB,SAAQ,uBAAsB;AAE9B,IAAI;AAEJ,SAAS,aAAa,gBAAyB;AAC7C,MAAI,gBAAgB;AAClB;AAAA,EACF,WAAY,QAAgB,SAAS;AACnC,WAAO;AAAA,EACT;AAEA,QAAM,cAAc,gBAAgB;AAEpC,QAAM,uBAA2C;AAAA,IAC/C,QAAQ;AAAA,IACR,kBAAkB;AAAA,IAClB,YAAY,YAAY;AAAA,IACxB,QAAQ;AAAA,EACV;AAEA,SAAQ,QAAgB,MAAM,oBAAoB;AACpD;AAEO,SAAS,kBAAkB,gBAAyB;AACzD,kBAAgB,aAAa,cAAc;AAC7C;AAEO,SAAS,aAAa;AAC3B,SAAO;AACT;AAEO,SAAS,cACd,OACA,UACgB;AAChB,MAAI,CAAC,UAAU;AACb,WAAO;AAAA,EACT;AAEA,QAAM,kBAAkB,CAAC,YAAoB;AAC3C,WAAO,QAAQ,QAAQ,IAAI,OAAO,UAAU,GAAG,GAAG,KAAK;AAAA,EACzD;AAEA,MAAI,iBAAiB,OAAO;AAC1B,UAAM,aAAa,OAAO,OAAO,OAAO,eAAe,KAAK,CAAC;AAC7D,WAAO,OAAO,YAAY,OAAO;AAAA,MAC/B,SAAS,gBAAgB,MAAM,OAAO;AAAA,MACtC,OAAO,MAAM,QAAQ,gBAAgB,MAAM,KAAK,IAAI;AAAA,IACtD,CAAC;AAED,WAAO;AAAA,EACT;AAEA,SAAO,gBAAgB,KAAK;AAC9B","sourcesContent":["import Bugsnag from '@bugsnag/node';\nimport * as BugsnagCore from '@bugsnag/core';\n\nimport {loadPackageJson} from './utils.js';\n\nlet BugsnagClient: BugsnagCore.Client | undefined;\n\nfunction setupBugsnag(disableBugsnag: boolean) {\n  if (disableBugsnag) {\n    return;\n  } else if ((Bugsnag as any)._client) {\n    return Bugsnag;\n  }\n\n  const packageJson = loadPackageJson();\n\n  const bugsnagServerOptions: BugsnagCore.Config = {\n    apiKey: '21fd37fe87ead4b9c5a8eed90752b455',\n    autoDetectErrors: true,\n    appVersion: packageJson.version,\n    logger: null,\n  };\n\n  return (Bugsnag as any).start(bugsnagServerOptions);\n}\n\nexport function initializeBugsnag(disableBugsnag: boolean) {\n  BugsnagClient = setupBugsnag(disableBugsnag);\n}\n\nexport function getBugsnag() {\n  return BugsnagClient;\n}\n\nexport function sanitizeError(\n  error: Error | string,\n  rootPath?: string,\n): Error | string {\n  if (!rootPath) {\n    return error;\n  }\n\n  const replaceRootPath = (message: string) => {\n    return message.replace(new RegExp(rootPath, 'g'), '***');\n  };\n\n  if (error instanceof Error) {\n    const cleanError = Object.create(Object.getPrototypeOf(error));\n    Object.assign(cleanError, error, {\n      message: replaceRootPath(error.message),\n      stack: error.stack ? replaceRootPath(error.stack) : undefined,\n    });\n\n    return cleanError;\n  }\n\n  return replaceRootPath(error);\n}\n"]}